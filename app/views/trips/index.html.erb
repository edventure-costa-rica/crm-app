<% if @client %>
<ol class="breadcrumb">
  <li><%= link_to @client, client_url(@client) %></li>
  <li class="active">Trips</li>
</ol>
<% elsif @controller.action_name != 'index' %>
  <ol class="breadcrumb">
    <li><%= link_to 'Trips', trips_url %></li>
    <li class="active"><%= @controller.action_name.humanize %></li>
  </ol>
<% else %>
  <ol class="breadcrumb">
    <li><%= link_to 'Home', home_url %></li>
    <li class="active">Trips</li>
  </ol>
<% end %>

<div class="row">
  <div class="col-xs-12">
    <h1>
      <%= if @upcoming then t '.upcoming' else t '.title' end %>
      <% if @client %><small><%= @client %></small><% end %>
    </h1>
  </div>
</div>

<div class="row">
  <div class="col-xs-12">

    <table class="table table-striped table-condensed">
      <tr>
        <th><%=tr_f :registration_id %></th>
        <% unless @client %>
          <th><%=tr_f :client %></th>
        <% end %>
        <th><%=tr_f :arrival %></th>
        <th><%=tr_f :departure %></th>
        <th>Updated</th>
        <th></th>
      </tr>

      <% @trips.each do |trip| %>
        <tr class="<%= cycle 'even', 'odd' %>">
          <td>
            <% link_to trip_url(trip) do %>
              <% if trip.pending? %>
                <i class="glyphicon glyphicon-hourglass"></i>
              <% elsif trip.confirmed? %>
                <i class="glyphicon glyphicon-tag"></i>
              <% else %>
                <i class="glyphicon glyphicon-remove"></i>
              <% end %>

              <%= trip.registration_id %>
            <% end %>
          </td>
          <% unless @client %>
            <td><%=h trip.client.family_name %></td>
          <% end %>
          <td>
            <% link_to day_calendar_url(date: trip.arrival.to_date) do %>
              <i class="glyphicon glyphicon-calendar hidden-xs hidden-sm"></i>
              <%= l(trip.arrival.to_date) %>
            <% end %>
          </td>
          <td>
            <% link_to day_calendar_url(date: trip.departure.to_date) do %>
              <i class="glyphicon glyphicon-calendar hidden-xs hidden-sm"></i>
              <%= l(trip.departure.to_date) %>
            <% end %>
          </td>
          <td><%= l trip.updated_at, format: :short %></td>
          <td>
            <div class="btn-group">
              <button class="btn btn-primary btn-xs edit-trip"
                      id="edit-trip-<%= trip.id %>"
                      data-action="<%= h trip_url(trip) %>"
                      data-trip="<%= h trip.to_json %>">
              <i class="glyphicon glyphicon-pencil"></i>
                Edit
              </button>

              <% link_to trip_url(trip), :confirm => t(:confirm),
                         :method => :delete, class: 'btn btn-xs btn-danger' do %>
                <i class="glyphicon glyphicon-trash"></i>
                Delete
              <% end %>
            </div>
          </td>
        </tr>
      <% end %>
    </table>

  </div>
</div>


<div class="modal fade" id="edit-trip-modal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Edit Trip <small id="edit-trip-id"></small></h4>
      </div>

      <div class="modal-body">
        <div class="react-mount"></div>
      </div>
    </div>
  </div>
</div>
