<%= render :partial => 'links' if @client and @trip %>

<h1>
  <%=t '.title' %>
  <small><%= @client || @company.name %></small>
</h1>

<% if @trip then %>
<p><%=t '.desc', :link => link_to(@trip, [@trip.client, @trip]) %></p>
<% end %>

<table class="table table-condensed table-striped">
  <tr>
    <th><%=h re_f :arrival %></th>
    <th><%=h re_f :departure %></th>
<% unless @client %>
    <th><%=h re_f :client %></th>
    <th><%=h re_f :trip_id %></th>
<% else %>
    <th><%=h re_f :company %></th>
    <th><%=h re_f :confirmed %></th>
    <th><%=h re_f :paid %></th>
<% end %>
    <th><%=h re_f :services %></th>
    <th></th>
  </tr>

<% @reservations.each do |reservation| %>
  <% company = reservation.company %>
  <tr class="<%= cycle 'even', 'odd' %>">
    <td class="col-xs-1">
      <%= if @client then 
            h l reservation.arrival, :format => :short
          else
            h l reservation.arrival, :format => :long
          end %>
    </td>
    <td class="col-xs-1">
      <%= if @client then
            h l reservation.departure, :format => :short
          else
            h l reservation.departure, :format => :long
          end %>
    </td>
<% unless @client %>
    <td><%=h reservation.client %></td>
    <td><%=h reservation.trip %></td>
<% else %>
    <td class="col-xs-2 col-sm-3">
      <% if company.kind == 'hotel' %>
        <i class="glyphicon glyphicon-bed" title="<%= co_f company.kind %>"></i>
      <% elsif company.kind == 'transport' %>
        <i class="glyphicon glyphicon-road" title="<%= co_f company.kind %>"></i>
      <% elsif company.kind == 'tour' %>
        <i class="glyphicon glyphicon-sunglasses" title="<%= co_f company.kind %>"></i>
      <% else %>
        <i class="glyphicon glyphicon-question-sign" title="<%= co_f company.kind %>"></i>
      <% end %>

      <%=h reservation.company.name %>
      <em><small><%=h company.city %></small></em>
    </td>

    <td><%=reservation.confirmed ? t(:true) : t(:false) %></td>
    <td><%=reservation.paid ? t(:true) : t(:false) %></td>
<% end %>
    <td class="col-xs-3 col-sm-4" title="<%= reservation.services.to_s %>">
      <%=hnl truncate reservation.services.to_s, length: 40 %>
    </td>
<% if reservation.client.nil? %>
  <td></td>
<% else %>
    <td class="col-xs-3 col-md-2">
      <div class="btn-group">
        <%= link_to t(:details), client_trip_reservation_url(reservation.client, reservation.trip, reservation), class: 'btn btn-xs btn-info' %>
        <%= link_to t(:edit), edit_client_trip_reservation_path(reservation.client, reservation.trip, reservation), class: 'btn btn-xs btn-primary' %>
        <%= link_to t(:delete), client_trip_reservation_url(reservation.client, reservation.trip, reservation), :confirm => t(:confirm), :method => :delete, class: 'btn btn-xs btn-danger' %>
      </div>
    </td>
<% end %>
  </tr>
<% end %>
</table>
