<% form_for([@client, @trip, @reservation], html: {class: 'form'}) do |f| %>
  <%= f.error_messages %>


  <div class="form-group">
    <%= f.label :trip_id %><br />

    <p class="form-control-static">
      <i class="glyphicon glyphicon-plane"></i>
      <%= link_to @trip, client_trip_path(@client, @trip) %>
      <br/>

      <%= f.hidden_field :trip_id %>
      <%= h l @trip.arrival.to_date, format: :long %> &ndash;
      <%= h l @trip.departure.to_date, format: :long %><br/>
    </p>
  </div>

  <div class="form-group">
    <%= f.label :client %><br />
    <p class="form-control-static">
      <i class="glyphicon glyphicon-user"></i>
      <%= link_to @client, @client %>
      <br>
      <%= @trip.total_people %> pax /
      <%= @trip.num_children %> children /
      <%= @trip.num_disabled %> disabled
    </p>
  </div>

  <div class="form-group">
    <% company_label = capture do %>
      <% case @kind when 'hotel' %>
        <i class="glyphicon glyphicon-bed" title="<%= co_f @kind %>"></i>
      <% when 'transport' %>
        <i class="glyphicon glyphicon-road" title="<%= co_f @kind %>"></i>
      <% when 'tour' %>
        <i class="glyphicon glyphicon-sunglasses" title="<%= co_f @kind %>"></i>
      <% when nil %>
      <% else %>
        <i class="glyphicon glyphicon-question-sign" title="<%= co_f @kind %>"></i>
      <% end %>
      <%= co_f @kind %>
    <% end %>
    <%= f.label :company_id, company_label %>
    <br/>

    <%= f.select :company_id, @companies.map { |c| [ c.name, c.id ] },
                 { :prompt => true }, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :reservation_id %><br />
    <%= f.text_field :reservation_id, class: 'form-control' %>
  </div>

  <div class="checkbox">
    <% checkbox = capture do %>
      <%= f.check_box :confirmed %>
      <%= re_f :confirmed %>
    <% end %>

    <%= f.label :confirmed, checkbox %>
  </div>

  <div class="form-group" id="toggle_confirm">
    <%= f.label :confirmation_no %><br />
    <%= f.text_field :confirmation_no, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :arrival %><br />
    <div class="row">
      <div class="col-xs-4">
        <%= f.select_year :arrival, {}, class: 'form-control' %>
      </div>
      <div class="col-xs-5">
        <%= f.select_month :arrival, {}, class: 'form-control' %>
      </div>
      <div class="col-xs-3">
        <%= f.select_day :arrival, {}, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :arrival_time %><br />
    <%= f.text_field :arrival_time, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :pickup_location %><br />
    <%= f.text_field :pickup_location, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :departure %><br />
    <div class="row">
      <div class="col-xs-4">
        <%= f.select_year :departure, {}, class: 'form-control' %>
      </div>
      <div class="col-xs-5">
        <%= f.select_month :departure, {}, class: 'form-control' %>
      </div>
      <div class="col-xs-3">
        <%= f.select_day :departure, {}, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :departure_time %><br />
    <%= f.text_field :departure_time, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :dropoff_location %><br />
    <%= f.text_field :dropoff_location, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :num_people %><br />
    <%= f.number_field :num_people, class: 'form-control', min: 1, step: 1 %>
  </div>

  <div class="form-group">
    <%= f.label :net_price %><br />
    <% net_price = number_with_precision(@reservation.net_price, :precision => 2) %>
    <%= f.number_field :net_price, class: 'form-control',
                       step: 0.01, value: net_price %>
  </div>

  <div class="form-group">
    <%= f.label :price %><br />
    <% rack_price = number_with_precision(@reservation.price, :precision => 2) %>
    <%= f.number_field :price, class: 'form-control',
                       step: 0.01, value: rack_price %>
  </div>

  <div class="form-group">
    <% paid_label = capture do %>
      <%= f.check_box :paid %>
      <%= re_f :paid %>
    <% end %>

    <%= f.label :paid, paid_label %>
  </div>

  <div class="form-group" id="toggle_paid">
    <%= f.label :paid_date %><br />

    <div class="row">
      <div class="col-xs-4">
        <%= f.select_year :paid_date, {include_blank: true}, class: 'form-control' %>
      </div>
      <div class="col-xs-5">
        <%= f.select_month :paid_date, {include_blank: true}, class: 'form-control' %>
      </div>
      <div class="col-xs-3">
        <%= f.select_day :paid_date, {include_blank: true}, class: 'form-control' %>
      </div>
    </div>
  </div>

  <div class="form-group">
    <%= f.label :services %><br />
    <%= f.text_area :services, :rows => 3, class: 'form-control' %>
  </div>

  <div class="form-group">
    <%= f.label :notes %><br />
    <%= f.text_area :notes, rows: 3, class: 'form-control' %>
  </div>

  <p>
    <%= f.submit submit_text, class: 'btn btn-primary' %>
    <%= reset_button class: 'btn btn-danger' %>
  </p>
<% end %>
